<div class="container">

  <div class="row mb-5 mt-5">
    <div class="col-8">
      <div class="container-cards-show">
        <% @flat.photos.each do |photo| %>
          <%= cl_image_tag photo.key, height: 200, width: 350, crop: :fill %>
        <% end %>
      </div>
    </div>
    <div class="col-4">
      <div class="container-description">
        <h2><%= @flat.title %></h2>
        <p><%= @flat.description %></p>
        <p>Number of guests allowed: <%= @flat.number_of_guests %></p>
        <p><%= @flat.price_per_day %>$ per day</p>
        <p>Address: <%= @flat.address %></p>
        <% if current_user == @flat.user %>
          <p><%= link_to "Delete flat",
                          dashboard_flats_path,
                          method: :delete,
                          data: { confirm: "Are you sure?" },
                          class: "btn btn-danger" %></p>
        <% end %>
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col-6">
      <div id="map"
        style="width: 100%; height: 400px;"
        data-markers="<%= @markers.to_json %>"
        data-mapbox-api-key="<%= ENV['MAPBOX_API_KEY'] %>">
      </div>
    </div>
    <div class="col-6">
      <% if current_user != @flat.user %>
        <h2>New reservation for <%= @flat.title %></h2>
        <%= simple_form_for([@flat, @reservation]) do |f| %>
          <%= f.input :reservation_start %>
          <%= f.input :reservation_end %>
          <%= f.input :number_of_guests %>
          <%= f.submit "Book the flat", class: "btn btn-primary"%>
        <% end %>
      <% end %>
    </div>
  </div>
  <%= link_to "Back to flats", flats_path, class: "btn btn-secondary mt-3" %>
</div>
